<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attacker's Inbox</title>
    <style>
        body { font-family: sans-serif; background: #1e1e1e; color: #d4d4d4; padding: 2rem; }
        h1 { color: #d16c6c; }
        .container { background: #252526; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); max-width: 800px; margin: auto; }
        button { background: #d16c6c; color: white; border: none; padding: 10px 20px; border-radius: 5px; font-size: 16px; cursor: pointer; transition: background 0.3s; margin-bottom: 1rem; }
        #mail-list { list-style-type: none; padding: 0; }
        .email { border: 1px solid #333; border-radius: 5px; padding: 1rem; margin-bottom: 1rem; background: #3c3c3c; }
        .email-time { font-size: 0.8rem; color: #aaa; }
        .email-body { margin-top: 0.5rem; color: #73c991; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>受信箱 (attacker@example.com)</h1>
        <button onclick="checkMail()">メールをチェック</button>
        <ul id="mail-list"></ul>
    </div>

    <script>
        const mailList = document.getElementById('mail-list');
        const attackerEmail = 'attacker@example.com';

        async function checkMail() {
            const response = await fetch(`/api/mailbox/${attackerEmail}`);
            const mails = await response.json();
            mailList.innerHTML = ''; // Clear list

            if (mails.length === 0) {
                mailList.innerHTML = '<li>受信トレイは空です。</li>';
                return;
            }

            mails.reverse().forEach(mail => {
                const item = document.createElement('li');
                item.className = 'email';
                item.innerHTML = `
                    <div class="email-time">${new Date(mail.time).toLocaleString()}</div>
                    <div class="email-body">${mail.message}</div>
                `;
                mailList.appendChild(item);
            });
        }

        // Auto-refresh every 3 seconds
        checkMail();
        setInterval(checkMail, 3000);
    </script>
</body>
</html>
